This IS NOT 100% of my code, obviously, just a few improvments have been made to it.